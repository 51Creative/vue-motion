/*!
 * vue-motion v0.2.0
 * (c) 2017 Eduardo San Martin Morote
 * Released under the MIT License.
 */

!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(e.VueMotion=e.VueMotion||{})}(this,function(e){"use strict";function i(e,i,t,n,r,s,u){var o=-r*(i-n),l=-s*t,c=o+l,f=t+c*e,m=i+f*e;return Math.abs(f)<u&&Math.abs(m-n)<u?(a[0]=n,a[1]=0,a):(a[0]=m,a[1]=f,a)}function t(e,i,n){for(var a in i)if(Object.prototype.hasOwnProperty.call(i,a))if(o(i[a])||l(i[a])){if(!t(e[a],i[a],n[a]))return!1}else{if(0!==n[a])return!1;if(e[a]!==i[a])return!1}return!0}function n(e){e.component("Motion",c)}var a=[0,0],r={noWobble:{stiffness:170,damping:26,precision:.01},gentle:{stiffness:120,damping:14,precision:.01},wobbly:{stiffness:180,damping:12,precision:.01},stiff:{stiffness:210,damping:20,precision:.01}},s=window.requestAnimationFrame.bind(window),u=performance.now.bind(performance),o=Array.isArray.bind(Array),l=function(e){return null!==e&&"object"==typeof e},c={data:function(){return{currentValues:null,currentVelocities:null}},props:{value:Number,values:[Object,Array],tag:{type:String,default:"span"},spring:{type:[Object,String],default:"noWobble"}},computed:{springConfig:function(){return"string"==typeof this.spring?r[this.spring]:this.spring},realValues:function(){return null!=this.value?{value:this.value}:this.values}},render:function(e){return e(this.tag,[this.$scopedSlots.default(this.currentValues)])},watch:{realValues:function(e,i){i===e||this.wasAnimating||(this.prevTime=u(),this.accumulatedTime=0,this.animate())}},created:function(){var e=this.defineInitialValues(this.realValues,null);this.currentValues=e.values,this.currentVelocities=e.velocities},mounted:function(){this.prevTime=u(),this.accumulatedTime=0;var e=this.defineInitialValues(this.currentValues,this.currentVelocities);this.idealValues=e.values,this.idealVelocities=e.velocities,this.animate()},methods:{defineInitialValues:function(e,i){var t={},n={};return this.defineValues(e,i,t,n),{values:t,velocities:n}},defineValues:function(e,i,t,n){var a=this;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o(e[r])||l(e[r])?(t[r]={},n[r]={},a.defineValues(e[r],i&&i[r],t[r],n[r])):(t[r]=e[r],n[r]=i?i[r]:0))},animate:function(){var e=this;this.animationId=s(function(){if(t(e.currentValues,e.realValues,e.currentVelocities))return e.wasAnimating&&e.$emit("motion-end"),e.animationId=null,void(e.wasAnimating=!1);e.wasAnimating||e.$emit("motion-start"),e.wasAnimating=!0;var i=u(),n=i-e.prevTime;if(e.prevTime=i,e.accumulatedTime+=n,e.accumulatedTime>1e3/60*10&&(e.accumulatedTime=0),0===e.accumulatedTime)return e.animationID=null,e.$emit("motion-restart"),void e.animate();var a=(e.accumulatedTime-Math.floor(e.accumulatedTime/(1e3/60))*(1e3/60))/(1e3/60),r=Math.floor(e.accumulatedTime/(1e3/60)),s=e.springConfig;e.animateValues({framesToCatchUp:r,currentFrameCompletion:a,springConfig:s,realValues:e.realValues,currentValues:e.currentValues,currentVelocities:e.currentVelocities,idealValues:e.idealValues,idealVelocities:e.idealVelocities}),e.animationID=null,e.accumulatedTime-=r*(1e3/60),e.animate()})},animateValues:function(e){var t=this,n=e.framesToCatchUp,a=e.currentFrameCompletion,r=e.springConfig,s=e.realValues,u=e.currentValues,c=e.currentVelocities,f=e.idealValues,m=e.idealVelocities;for(var d in s)if(Object.prototype.hasOwnProperty.call(s,d))if(o(s[d])||l(s[d]))t.animateValues({framesToCatchUp:n,currentFrameCompletion:a,springConfig:r,realValues:s[d],currentValues:u[d],currentVelocities:c[d],idealValues:f[d],idealVelocities:m[d]});else{for(var p=f[d],V=m[d],h=s[d],v=0;v<n;v++){var g;g=i(1e3/60/1e3,p,V,h,r.stiffness,r.damping,r.precision),p=g[0],V=g[1]}var w=i(1e3/60/1e3,p,V,h,r.stiffness,r.damping,r.precision),b=w[0],y=w[1];u[d]=p+(b-p)*a,c[d]=V+(y-V)*a,f[d]=p,m[d]=V}}}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(n),n.presets=r;e.default=n,e.Motion=c,e.version="0.2.0",e.presets=r,Object.defineProperty(e,"__esModule",{value:!0})});